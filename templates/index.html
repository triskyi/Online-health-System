{% load static %}
{% static "image" as baseUrl %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <script src="{% static 'script.js' %}"></script>
    <title>Your Election Website</title>
</head>
<style>
    /* Style the container div */
    .forname {
        float: right;
        padding: 5px;
        background-color: #080808;
        border: 1px solid #1678e0;
        border-radius: 5px;
        text-align: center;
        margin: 5px;
    }

    /* Style the list item if the user is authenticated */
    .forname li {
        list-style: none;
        font-size: 18px;
        color: #fdfbfb;
        margin: 0;
        padding: 0;
    }

    #vote-button {
        background-color: #4CAF50;
        /* Green color */
        color: white;
        /* Text color */
        padding: 15px 30px;
        /* Increase padding for a larger button */
        border: none;
        /* Remove button border */
        cursor: pointer;
        /* Add a pointer cursor on hover */
        font-size: 18px;
        /* Increase font size for larger text */
    }

    #vote-button:hover {
        background-color: #45a049;
        /* Darker green on hover */
    }
</style>

<body>
    <header>

        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                {% if user.is_authenticated %}
                <li><a href="accounts/logout">Logout</a></li>
                {% else %}
                <li><a href="accounts/login">Login</a></li>
                <li><a href="{% url 'register' %}">Register</a></li>
                {% endif %}
                <div class="forname">
                    {% if user.is_authenticated %}
                    <li>{{ user.first_name}}</li>
                    {% endif %}
                </div>
            </ul>
        </nav>
    </header>
    <main>
        <h1>Welcome to BUSA Election Website</h1>
        {% for candidate in candidates %}
        <div class="card">
            <h2>{{ candidate.place }}</h2>
            <img src="{{ candidate.image.url }}" alt="Candidate Image">
            <p>Candidate: <span class="candidate-name">{{ candidate.name }}</span></p>
            <p>Current Vote Count: <span class="vote-count">{{ candidate.total_votes }}</span></p>
            {% if user.is_authenticated %}
            <form action="{% url 'vote' candidate_id=candidate.id %}" method="post">
                {% csrf_token %}

                <input type="submit" class="vote-button" name="vote" value="Vote">
            </form>
            {% endif %}


            <!-- Add the "Vote" button -->
            <!-- -->
            <!--<button class="vote-button" action="" method="POST">Vote</button>-->
            <!-- -->
        </div>
        {% endfor %}

    </main>
    <footer>
        <p>2023 BI TECH</p>
    </footer>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            // Add a click event listener to all "Vote" buttons
            $(".vote-button").click(function () {
                var candidateId = $(this).closest(".card").data("candidate-id");
                var voteCountElement = $(this).siblings("p").find(".vote-count");

                // Simulate incrementing the vote count by 1 for demonstration
                var currentVoteCount = parseInt(voteCountElement.text());
                var newVoteCount = currentVoteCount + 1;
                voteCountElement.text(newVoteCount);

                // In a real implementation, you would send an AJAX request to update the server-side vote count
                // and handle any success or error responses accordingly.
            });
        });
    </script>
</body>

</html>